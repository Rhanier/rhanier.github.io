<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Gr치fico da Planilha - P치gina2</title>
  <!-- Inclus칚o das bibliotecas -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h2>Gr치fico gerado a partir da aba "P치gina2"</h2>
  <canvas id="meuGrafico" width="600" height="400"></canvas>

  <script>
    async function carregarPlanilha() {
      const url = 'https://docs.google.com/spreadsheets/d/16IHVI9UkXfu-WE7fzLNcEMGY6Df3BXBa/export?format=xlsx';

      try {
        const response = await fetch(url);
        const arrayBuffer = await response.arrayBuffer();
        const workbook = XLSX.read(arrayBuffer, { type: "array" });

        // Verifica se a aba "P치gina2" existe
        const nomeAba = "P치gina2";
        if (!workbook.SheetNames.includes(nomeAba)) {
          throw new Error(`A aba "${nomeAba}" n칚o foi encontrada na planilha.`);
        }

        const aba = workbook.Sheets[nomeAba];
        const dados = XLSX.utils.sheet_to_json(aba);

        // Ajuste os nomes das colunas conforme sua planilha
        const labels = dados.map(linha => linha.M칡s || linha.Mes || linha.Meses || 'SemNome');
        const valores = dados.map(linha => linha.Valor || linha.Total || linha.Vendas || 0);
console.log("JSON da planilha:", labels); // 游녣 Aqui voc칡 ver치 o conte칰do

        // Cria칞칚o do gr치fico
        const ctx = document.getElementById('meuGrafico').getContext('2d');
        new Chart(ctx, {
          type: 'bar',
          data: {
            labels: labels,
            datasets: [{
              label: 'Valores da P치gina2',
              data: valores,
              backgroundColor: 'rgba(54, 162, 235, 0.5)',
              borderColor: 'rgba(54, 162, 235, 1)',
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            scales: {
              y: {
                beginAtZero: true
              }
            }
          }
        });

      } catch (erro) {
        console.error("Erro ao carregar a planilha:", erro);
      }
    }

    carregarPlanilha();
  </script>
</body>
</html>
